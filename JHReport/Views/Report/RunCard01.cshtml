
@{
    ViewBag.Title = "RunCard";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
}

<section class="content-header"></section>
<section class="content" ng-app="myApp">
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-primary" ng-controller="RunCardCtrl">
                <div class="box-header with-border">
                    <i class="fa fa-bar-chart-o"></i>
                    <h3 class="box-title">组件电子流转单</h3>
                </div>
                <div class="box-body">
                    <div class="form-inline">
                        <input id="LotID" class="form-control" type="text" placeholder="组件编码" />
                        <button class="btn btn-default" ng-click="QueryLot()">查询</button>
                        <button id="btnExportExcel" class="btn btn-default btn-sm export-xlsx-button">&nbsp<span class="button-inner"></span></button>
                    </div>
                </div>
                <div class="box-body table-responsive">
                    <table class="table table-bordered table-striped table-hover table-condensed" id="tbRuncard" style="display:none">
                        <tbody>

                            <tr>

                                <td colspan="12">生产基本信息</td>
                                
                            </tr>
                            <tr>

                                <td>投产信息</td>
                                <td ng-bind="lotidinfo.process_name">2018-01-01</td>
                                <td> 客户</td>
                                <td ng-bind="lotidinfo.cust_desc">晶科</td>
                                <td>线别</td>
                                <td ng-bind="xianbie">A线</td>
                                <td>订单号</td>
                                <td ng-bind="lotidinfo.product_code">112233</td>
                                <td>工单号</td>
                                <td ng-bind="lotidinfo.workorder"></td>
                                <td>产品规格</td>
                                <td ng-bind="lotidinfo.product_code"></td>
                            </tr>
                            <tr >
                                <td colspan="7">过站信息</td>
                                <td colspan="5">材料信息</td>
                            </tr>
                            <tr>

                                <td >焊接</td>
                                <td >焊接机台号</td>
                                <td ng-bind="weldinfo.wks_id"></td>
                                <td >焊接时间</td>
                                <td ng-bind="weldinfo.wks_visit_date"></td>
                                <td >焊接人员</td>
                                <td ng-bind="weldinfo.operator"></td>
                                <td rowspan="2">电池片</td>
                                <td >电池片批号</td>
                                <td></td>
                                <td>电池片厂家</td>
                                <td ng-bind="lotidinfo.cell_supplier_desc"></td>
                            </tr>
                            <tr style="">

                                <td>互联</td>
                                <td>互联机台号</td>
                                <td ng-bind=""></td>
                                <td>互联时间</td>
                                <td ng-bind=""></td>
                                <td>互联人员</td>
                                <td ng-bind=""></td>
                                <td>电池片颜色</td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr style="">

                                <td >层压前EL</td>
                                <td>层压前EL机台号</td>
                                <td ng-bind="ELBeforeLayup.wks_id"></td>
                                <td >测试时间</td>
                                <td ng-bind=""></td>
                                <td >是否返修</td>
                                <td ng-bind=""></td>
                                <td >高透EVA</td>
                                <td>高透EVA批号</td>
                                <td ng-bind="LaminationEVAinfo.lot_nbr"></td>
                                <td>高透EVA厂家</td>
                                <td ng-bind="LaminationHighEVAinfo.supplier_code"></td>
                            </tr>
                            <tr style="">

                                <td >层压</td>
                                <td >层压机台号</td>
                                <td ng-bind="weldinfo.wks_visit_date"></td>
                                <td >层压时间</td>
                                <td  ng-bind="weldinfo.operator"></td>
                                <td></td>
                                <td ></td>
                                <td>普通EVA</td>
                                <td >普通EVA批号</td>
                                <td ng-bind="LaminationEVAinfo.lot_nbr"></td>
                                <td>普通EVA厂家</td>
                                <td ng-bind="LaminationEVAinfo.supplier_code"></td>

                            </tr>
                            <tr style="">

                                <td colspan="2">层压后检验</td>
                                <td >层压后检验机台号</td>
                                <td ng-bind=""></td>
                                <td >检验时间</td>
                                <td ng-bind=""></td>
                                <td >检验人员</td>
                                <td ng-bind=""></td>
                                <td >背板</td>
                                <td>背板批号</td>
                                <td ng-bind="LaminationBackinfo.lot_nbr"></td>
                                <td>背板厂家</td>
                                <td ng-bind="LaminationBackinfo.supplier_code"></td>
                            </tr>
                            <tr>

                                <td>层压后检验结果</td>
                                <td ng-bind=""></td>
                                <td>不良描述</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td >玻璃</td>
                                <td >玻璃批号</td>
                                <td  ng-bind="LaminationGlassinfo.lot_nbr"></td>
                                <td >玻璃厂家</td>
                                <td ng-bind="LaminationGlassinfo.supplier_code"></td>
                            </tr>
                            <tr style="">

                                <td >组装</td>
                                <td >组装机台号</td>
                                <td ng-bind=""></td>
                                <td >组装时间</td>
                                <td ng-bind=""></td>
                                <td >组装人员</td>
                                <td  ng-bind="Cleaninfo.wks_visit_date"></td>
                                <td>双波玻璃</td>
                                <td >玻璃批号</td>
                                <td></td>
                                <td>玻璃厂家</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>固化时间</td>
                                <td ng-bind=""></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td>焊带</td>
                                <td>焊带规格</td>
                                <td></td>
                                <td>焊带厂家</td>
                                <td></td>
                            </tr>
                            <tr style="">

                                <td >清洗</td>
                                <td >清洗机台号</td>
                                <td ng-bind="Cleaninfo.wks_id"></td>
                                <td >清洗时间</td>
                                <td  ng-bind="Cleaninfo.wks_visit_date"></td>
                                <td >清洗人员</td>
                                <td  ng-bind="Cleaninfo.operator"></td><!--清洗机台编号-->
                                <td >助焊剂</td>
                                <td >助焊剂规格</td>
                                <td ></td>
                                <td>助焊剂厂家</td>
                                <td></td>
                                <!--开发到此处2018-7-31-->
                            </tr>
                            <tr style="">

                                <td >机台编号</td>
                                <td  ng-bind="LaminationEVAinfo.wks_id">M01DCT004</td><!--叠层机台编号-->
                                <td >EVA厂商</td>
                                <td  ng-bind="LaminationEVAinfo.supplier_code">福斯特</td>
                                <td  rowspan="2">全检</td>
                                <td >全检时间</td>
                                <td ></td>
                                <td >操作人员</td>
                                <td ></td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >高透EVA规格</td>
                                <td  ng-bind="LaminationHighEVAinfo.part_nbr">34002202.00</td>
                                <td >普通EVA规格</td>
                                <td  ng-bind="LaminationEVAinfo.part_nbr">34001019.00</td>
                                <td >机台编号</td>
                                <td ></td>
                                <td >全检结果</td>
                                <td ></td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >高透EVA批号</td>
                                <td  ng-bind="LaminationHighEVAinfo.lot_nbr">M11803260025</td>
                                <td >普通EVA批号</td>
                                <td  ng-bind="LaminationEVAinfo.lot_nbr">M11803260021</td>
                                <td  rowspan="2">电性能测试</td>
                                <td >机台编号</td>
                                <td  ng-bind="IVinfo.wks_id">IV001</td><!--电性能机台编号-->
                                <td >测试时间</td>
                                <td  ng-bind="IVinfo.wks_visit_date">2018-03-28 01:58:29</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >玻璃厂商</td>
                                <td  ng-bind="LaminationGlassinfo.supplier_code">福莱特</td><!--叠层玻璃厂商-->
                                <td >背板厂商</td>
                                <td  ng-bind="LaminationBackinfo.supplier_code">台虹TPE</td>
                                <td >测试功率</td>
                                <td  ng-bind="IVinfo.pmax">348.06</td>
                                <td >测试电流</td>
                                <td  ng-bind="IVinfo.isc">9.69</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >玻璃规格</td>
                                <td  ng-bind="LaminationGlassinfo.part_nbr">34001964.00</td>
                                <td >背板规格</td>
                                <td  ng-bind="LaminationBackinfo.part_nbr">34000118.00</td>
                                <td  rowspan="2">测试后EL</td>
                                <td >测试时间</td>
                                <td  ng-bind="ELAfterTestinfo.wks_visit_date">2018-03-28 01:59:42</td>
                                <td >操作人员</td>
                                <td ></td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >玻璃批号</td>
                                <td  ng-bind="LaminationGlassinfo.lot_nbr">M11803260024</td>
                                <td >背板批号</td>
                                <td  ng-bind="LaminationBackinfo.lot_nbr">M11803260020</td>
                                <td >机台编号</td>
                                <td  ng-bind="ELAfterTestinfo.wks_id">HEL001</td>
                                <td >测试结果</td>
                                <td  ng-bind="ELAfterTestinfo.el_grade">A</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >汇流条厂商</td>
                                <td ></td>
                                <td >汇流条批号</td>
                                <td ></td>
                                <td  rowspan="2">包装</td>
                                <td >操作时间</td>
                                <td  ng-bind="Packinfo.pack_date">2018-03-28 03:09:30</td>
                                <td >操作人员</td>
                                <td ></td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >汇流条规格</td>
                                <td ></td>
                                <td ></td>
                                <td ></td>
                                <td >机台编号</td>
                                <td  ng-bind="Packinfo.wks_id">DGBZ001</td>
                                <td >托盘编号</td>
                                <td  ng-bind="Packinfo.pallet_nbr"></td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td  rowspan="2">层压前EL</td>
                                <td >测试时间</td>
                                <td  ng-bind="ELBeforeLayup.wks_visit_date"></td>
                                <td >操作人员</td>
                                <td ></td>
                                <td  rowspan="2">入库</td>
                                <td >操作时间</td>
                                <td ></td>
                                <td >操作人员</td>
                                <td ></td>

                            </tr>
                            <tr style="">

                                <td >机台编号</td>
                                <td  ng-bind="ELBeforeLayup.wks_id"></td>
                                <td >测试结果</td>
                                <td  ng-bind="ELBeforeLayup.el_grade"></td>
                                <td >库位编号</td>
                                <td ></td>
                                <td >出货柜号</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td  rowspan="3">层压</td>
                                <td >操作时间</td>
                                <td ></td>
                                <td >操作人员</td>
                                <td ></td>
                                <td  rowspan="2">返工</td>
                                <td >操作时间</td>
                                <td ></td>
                                <td >操作人员</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >机台编号</td>
                                <td ></td>
                                <td >层压温度</td>
                                <td ></td>
                                <td >换片数量</td>
                                <td ></td>
                                <td >不良说明</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >层压时间</td>
                                <td ></td>
                                <td >抽真空时间</td>
                                <td ></td>
                                <td  rowspan="2">检验评审</td>
                                <td >操作人员</td>
                                <td ></td>
                                <td >操作时间</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td  rowspan="2">层压后EL</td>
                                <td >测试时间</td>
                                <td ></td>
                                <td >操作人员</td>
                                <td ></td>
                                <td >外观等级</td>
                                <td ></td>
                                <td >EL等级</td>
                                <td ></td>
                            </tr>
                            <tr style="">

                                <td >机台编号</td>
                                <td ></td>
                                <td >测试结果</td>
                                <td ></td>
                                <td >备注</td>
                                <td ></td>
                                <td ></td>
                                <td ></td>
                                <td ></td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </div>
</section>

<script src="~/3rd/tableexport20180710/xlsx.core.js"></script>
<script src="~/3rd/tableexport20180710/FileSaver.js"></script>
<script src="~/3rd/tableexport20180710/dist/js/tableexport.js?v=2"></script>
<script src="~/3rd/Angularjs/angular.min.js?v=1"></script>
@*<script src="~/3rd/Angularjs/angular-route.min.js"></script>*@
<script src="~/Scripts/Report/RunCard/app.js"></script>
<script src="~/Scripts/Report/RunCard/controller.js?v=8"></script>
<script>
    $('#btnExportExcel').click(function () {
        var ExportButtons = document.getElementById('tbRuncard');

        var instance = new TableExport(ExportButtons, {
            formats: ['xlsx'],
            exportButtons: false
        });

        //                                        // "id" of selector    // format
        var exportData = instance.getExportData()['tbRuncard']['xlsx'];

        //var XLSbutton = document.getElementById('customXLSButton');

        //XLSbutton.addEventListener('click', function (e) {
            //                   // data          // mime              // name              // extension
            instance.export2file(exportData.data, exportData.mimeType, exportData.filename, exportData.fileExtension);
        //}); 
    }) 

    
</script>